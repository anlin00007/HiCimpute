Data Process
Hi-C data.	The Hi-C data is obtained from Rao et al. 2014 under GEO series GSE63525. Six human cell types (B-lymphoblastoid cells (GM12878), human mammary epithelial cells (HMEC), umbilical vein endothelial cells (HUVEC), human lung fibroblast cells (IMR90), NHEK and erythrocytic leukaemia cells (K562)) were included in this study. The raw read counts at 5Kb, 10Kb and 25Kb resolution have been used.
Epigenome data.	The histone modification and chromatin accessibility (DNase-Seq) data were downloaded from NIH Roadmap Epigenomics project (http://www.roadmapepigenomics.org/), including H2A.Z, H3K27ac, H3K27me3, H3K36me3, H3K4me1, H3K4me2, H3K4me3, H3K79me2, H3K9ac, H3K9me3 and H4K20me1. CTCF Chip-Seq data were downloaded from ENCODE project (https://www.encodeproject.org/). The downloaded data were in BigWig format. The ‘bigWigAverageOverBed’ was used to segment signal into windows according to resolution of Hi-C data.
ChromHMM segmentation of 127 Roadmap celltype/tissues was downloaded from (http://www.roadmapepigenomics.org/). The 18-state assignment from 6 Histone marks (H3K4me1, H3K4me3, H3K27ac, H3K27me3, H3K36me3 and H3K9me3 was applied to this study.
ChIA-PET measures a specific type of interaction in genome-wide. It overlaps with Hi-C captured interactions but holds higher confidence and interpretability. ChIA-PET dataset of Gm12878 and K562 was obtained from Tang et al 2015 [1] under GEO session GSE72816. We mapped each ChIA-PET interaction to Hi-C map, which result in binary matrix at a given Hi-C resolution, denoting whether two regions are in contact or not as indicated by ChIA-PET or not. 
CTCF pre-processed peaks were derived from ENCODE project. All peaks are mapped into bins with fixed size as Hi-C resolution which generates binary values indicating the occurrence of CTCF binding events in each bin.

TAD boundary estimation 
Topologically associating domains (TADs) is known as structure units with average 1Mb length and high local interaction frequency. TADs are separated by boundaries that are enriched with insulators and housekeeping genes. Previous works show that over 90% of boundaries recruit CTCF pairs with their motifs in opposite direction. Thus, to address the difference of interaction strength between contacts that within and out of the same TADs, we defined a ‘boundary variable’ that estimate the number of boundaries between contacting pairs. by counting CTCFs that has opposite motifs. Boundary variable shows high correlation with experimentally called TADs boundaries in modeling interaction frequencies.
Another estimation approach is based on 

Peak Calling in Hi-C dataset
Fit-Hi-C [3] estimates statistical confidence of intra-chromosomal contacts detected by Hi-C experiments. It adjusts random polymer looping effect and technical biases in Hi-C data sets. We applied this method to our predicted chromatin interactions with a distance range from 20Kb to 5Mb. The q-values [4] (Benjamini and Hochberg, 1995) to ssess the contact probability of two regions.

Selection of Non-interacting pairs of regions
Each ChIA-PET dataset only indicates a unique type of interaction. The regions without ChIA-PET data may contain other type of interactions. Therefore, instead of selecting the non-interacting pairs from all ChIA-PET uncovered regions, we restricted our selection to contact pairs where both sides contain corresponding ChIA-PET protein.

Evaluation
Hi-C data has ‘distance decay’ feature, which makes direct correlation between two matrices fail to reflect the real similarity. Moreover, the systematic bias and inadequate sequencing depth in Hi-C experiment lead to missing information in some regions, but our prediction model returns interaction frequency in certain regions based on signals from epigenetic features. To address those issues and benchmark with existing methods, we propose three evaluation approaches:
a. By distance correlation: To avoid the effect of genomic distance on Hi-C interaction frequencies, we propose to calculate the correlation between experiment matrix and predicted matrix with grouping contact pairs that have same genomic distance. By plotting the correlation along with genomic distance, it is feasible to measure the overall similarity between two matrices.
b. Validation by other chromatin conformation data: Besides measuring genome-wide prediction quality, we also performed validation on prediction of specific interactions. ChIA-PET measures a specific type of interaction in genome-wide. Thus, we first assessed the similarity between experiment and predicted matrices on regions covered by both ChIA-PET and Hi-C. For regions without signal in experiment Hi-C matrix but in predicted Hi-C matrix, we checked the presence of signal in ChIA-PET or other available conformation data.
c. Overlap of TADs: TADs are stable structure units across cell types and even species. The high quality predicted matrix would be expected to have similar TAD structure with experiment matrix. we will first call TADs on both types of matrices. Then we can screen each contact pair and check if two corresponding loci are from same TAD in both experimental and predicted matrices. The proportion of contact pairs show agreement in two types of matrices will be measured to reflect TADs similarity.
